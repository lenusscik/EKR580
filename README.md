# EKR580
EKR580 is an assembler emulator on the KR580VM80 microprocessor. 

Приветствую, данное руководство предназначено для знакомства с программой EKR!  
Язык Ассемблера относится к машинно-ориетированным языкам низкого уровня. Каждой команде языка Ассемблера соответствует, как правило, машинная команда. Каждый тип МП имеет свою систему команд и, следовательно, свой язык Ассемблера. Команды, адреса и данные записываются в виде буквенно-цифровых символов. Мнемонические обозначения команд обычно легко ассоциируются с реально выполняемыми действиями (в англоязычном написании).

Микропроцессор работает только с двоичными кодами. Среди совокупности этих кодов имеется определенная группа кодов, каждый из которых может «заставить» микропроцессор выполнить определенные действия (операции). Такой код часто называется кодом команды и, как правило, определяет одну команду из системы команд микропроцессора. Код любой команды представляется в запоминающем устройстве двоичным восьмиразрядным числом (байтом). Всего с помощью байта можно формировать 2^8 = 256 различных кодовых комбинаций. Почти столько же команд (244) имеет микропроцессор КР580ВМ80.  Естественно, что запомнить  244  кода довольно трудно, и поэтому каждому коду ставится в соответствие мнемоническое название (мнемоника) команды, которое является сокращением от английских слов, описывающих ее действие. Мнемонический код команд позволяет легче запомнить их функции и значительно упрощает написание программ. Такой язык написания программ называется Ассемблером. После того, как программа написана на Ассемблере, ее необходимо снова перевести на язык, понятный микропроцессору, т. е. перевести в последовательность двоичных восьмиразрядных чисел. Перевод в последовательность двоичных цифр может происходить автоматически с помощью специальных про­грамм-трансляторов (такие программы носят название «кросс-ассемблер» или «ассемблер») или вручную.

Для ручной трансляции можно использовать "Панель команд", находящуюся на вкладке "Помощь", в которой приведены все команды микропроцессора КР580ВМ80. С помощью этой таблицы можно легко и быстро сопоставить мнемонику команды с ее кодом . Код  каждой команды приведен здесь в верхней горизонтальной строке (младшие раз­ряды) и в крайнем левом столбце (старшие разряды) в шестнадцатеричной системе счисления. Например, команда STAX D имеет код 12Н, команда JZ ADR — код  СА.

Система команд микропроцессора – это полный перечень элементарных действий, которые может выполнить микропроцессор. Управляемый командами микропроцессор выполняет очень про­стые действия, однако с помощью этих действий (команд) можно запрограммировать  любую  сложную  операцию.

Проектировщику  необходимо запомнить весь перечень команд и хорошо представлять действия, которые будет выполнять микропроцессор при их обработке.

Программная модель системы, построенной на базе микропро­цессора серии КР580, состоит из следующих элементов:

программно-доступных регистров и триггеров разрешения прерывания;

программно-доступных восьмиразрядных ячеек памяти;

программно-доступных восьмиразрядных регистров.

Программно - доступные регистры микропроцессора – это ре­гистры общего назначения, регистр указателя стека, регистр признаков и регистр счетчика команд. Разряды регистров нуме­руются справа налево целыми числами, начиная с нуля.

Регистр общего назначения (РОН) — это один из шести восьми­разрядных регистров микропроцессора, обозначенных буквами  В, С, D, Е, Н, L, или аккумулятор, обозначенный буквой А. Ре­гистры В и С, D и Е, Н и L в некоторых командах рассматри­ваются как шестнадцатиразрядные регистры, называемые реги­стровыми парами. Регистры В, D и Н образуют старшие восемь разрядов регистровых пар, а регистры С, Е и L – младшие.

Регистр указатель стека (УC) — это шестнадцатиразрядный регистр, который содержит адрес вершины стека. Стек – это динамическая последовательная структура данных в ОЗУ, орга­низованная таким образом, что очередная запись данных всегда осуществляется в вершину (начало) стека. Максимальный размер стека равен адресуемой емкости памяти. В вершину сте­ка могут записываться только шестнадцатибитные данные. При записи данных в стек содержи­мое регистра указателя стека уменьшается на 2, а при считы­вании — увеличивается на 2.

Регистр признаков (F) — это восьмиразрядный регистр, содер­жащий признаки результата выполнения команды (рис. 1).

Распределение признаков по разрядам
 7 6 5 4  3 2 1 0
__________________
|S|Z|0|AC|0|P|1|C|

S – признак знака;

Z – признак нуля;

AC – признак дополнительного переноса;

P – признак четности;

C – признак переноса.

Признаки устанавливаются следующим образом:

- признак S — единица, если седьмой разряд результата равен единице, в противном случае — ноль;

- признак нуля Z — единица, если во всех разрядах результата ноли, в противном случае — ноль;

- признак дополнительного переноса V — единица при переносе из третьего разряда или при заеме в третий разряд результата, в противном случае — ноль;

- признак четности Р — единица, если результат в двоичном коде содержит четное количество единиц, в противном случае — ноль;

- признак переноса С — единица при переносе из седьмого раз­ряда или при заеме в седьмой разряд результата, в противном случае — ноль.

Аккумулятор и регистр признаков образуют слово состояния процессора, обозначенное буквами PSW. Аккумулятору соответствуют восемь старших разрядов, а регистру признаков — младшие.

Регистр счетчика команд  (СК) — это шестнадцатиразрядный регистр, указывающий адрес следующей команды, которая должна быть выполнена микропроцессором.

Программно-доступные восьмиразрядные ячейки памяти используются в качестве памяти микропроцессорной системы (МПС) . Разряды ячейки памяти нумеруются справа налево целыми числами, начиная с ноля. Максимальная емкость памяти, реализуемой запоминающим устройством, равна 65 536 байт.

Программно-доступные восьмиразрядные регистры используются для ввода и вывода. Максимальное число регистров для ввода данных составляет 256, для вывода данных — столько же.

Команды микропроцессора используют только те элементы данных, обработка которых осуществляется непосредственно микропроцессором, т. е. восьми- и шестнадцатибитовые. Восьмибитовые данные — это восемь бит (один байт), которые хранятся в РОН или ячейке памяти и обрабатываются микропроцессором как одно целое.

Шестнадцатибитовые данные — это 16 бит (два байта) данных, которые могут храниться в шестнадцатиразрядном регистре или в двух последовательных ячейках памяти и обрабатываются микропроцессором как одно целое, причем в памяти старшие восемь бит записываются по адресу на единицу большему, чем адрес младших. При адресации шестнадцатибитовых данных указывается адрес младшей ячейки памяти, содержащей эти данные.

Операнды команд могут храниться в программно-доступных регистрах микропроцессора или в памяти МПС. Для указания операнда в регистре используются: регистровая адресация и регистровая неявная адресация.

При регистровой адресации в коде команды существует поле для указания регистра, содержащего операнд. При регистровой неявной адресации специального поля в коде команды нет.

Для указания операнда в памяти используются адресации: непосредственная, прямая, косвенная и стековая.

При непосредственной адресации операнд задается в команде. При прямой адресации в команде указывается адрес операнда. При косвенной регистровой адресации адрес операнда указывается в регистровой паре или для команды XTHL — в регистре указателя стека.

	Команды микропроцессора КР580ВМ80

Команды микропроцессора делятся на группы: команды пересылки и загрузки данных, команды обмена данными, арифметические команды, команды поразрядной обработки данных, команды передачи управления, команды управления микропроцессором. Команды могут быть длиной один, два или три байта. При описании команд (ниже) байты разделены штрихами.

Команды пересылки и загрузки данных:

- MOV R1,R2 – пересылка из регистра в регистр;

- LDAX B(D) – пересылка из ячейки памяти, адрес которой записан в  регистровой паре ВС (DE), в аккумулятор;

- STAX В(D) – пересылка из аккумулятора в ячейку памяти, адрес которой записан в регистровой паре BC (DE);

- LDA_B2_B3 – пересылка из ячейки памяти, адрес  которой записан во втором и третьем байтах команды, в аккумулятор;

- STA_B2_B3 – пересылка из аккумулятора в ячейку памяти, адрес которой указан во втором и третьем байтах команды;

- SPHL – пересылка данных из регистровой пары HL в указатель стека;

- PCHL – пересылка данных из регистровой пары HL в счетчик команд;

- LHLD_B2_B3 – пересылка данных из ячеек памяти с адресами, записанным во втором и третьем байтах команды и на единицу большем, в регистровую пару HL;

- SHLD_B2_B3 – пересылка данных из регистровой пары HL в ячейки памяти с адресами, записанными во втором и третьем байтах команды и на единицу большем;

- MVI R_B2 – загрузка  второго байта команды в регистр R;

- LXI B (D,H)_B2_B3 – загрузка второго и третьего байтов команды в регистровую пару BС (DЕ,HL).

Команды обмена данными:

- XCHG – обмен данными между парами регистров HL и DE;

- XTHL – обмен данными между парой регистров HL и вершиной стека (L)->[УC], (H)->[УC+1].
 
Группа арифметических команд.

Команды сложения :

- ADD R – сложение содержимого аккумулятора с содержимым регистра R  (A) = (A) + (R);

- ADI_B2 – сложение содержимого аккумулятора со вторым байтом команды (A) = (A) + B2;

- ADC R – сложение содержимого аккумулятора с содержимым регистра R и признаком (С)  (А) = (A) + (R) + (С);

- ACI_B2 – сложение содержимого аккумулятора со вторым байтом команды и признаком (С) (A) = (A) + B2 + (С);

- DAD B (D, H, SP) – сложение содержимого пары регистров HL с содержимым пары регистров BC (DE или HL  или указателем стека) и 
запись результата в пару HL.
 
Команды вычитания :

- SUB R – вычитание из содержимого  аккумулятора содержимого регистра R (A) = (A) – (R);

- SUI_B2 – вычитание из содержимого аккумулятора  второго байта команды (A) = (A) – B2;

- SBB R – вычитание из содержимого аккумулятора содержимого регистра R и признака (С)  (А) = (A) – (R) – (С);

- SBI_B2 – вычитание из содержимого аккумулятора второго байта команды и признака (С)  (A) = (A) – B2 – (С).
 
Операции инкремента и декремента:

- INR  R  –  увеличение содержимого  регистра на 1  (R) +1 -> (R);

- INX B (D, H, SP) – увеличение содержимого пары регистров BC (DE), (HL), (SP) на 1 ;

- DCR R – уменьшение содержимого регистра R на 1 (R) -1 -> (R);

- DCX B ( D, H, SP) – уменьшение содержимого пары регистров BC  (DE), (HL), (SP) на 1 .

Группа команд поразрядной обработки данных.

Логические команды :

- ANA R – операция “И” между содержимым аккумулятора и содержимым регистра (A) ¬ (A) AND (R);

- ANI_B2 – операция “И” между содержимым аккумулятора и вторым байтом команды (A) ¬ (A) AND B2;

- ORA R – операция “ИЛИ” между содержимым аккумулятора и содержимым регистра R (A) ¬ (A) OR (R);

- ORI_B2 – операция  “ИЛИ” между содержимым аккумулятора и вторым байтом команды (A) ¬ (A) OR B2;

- XRA R – операция “ИЛИ-НЕ” между содержимым аккумулятора и содержимым регистра R (A)  ¬ (A) XOR (R);

- XRI_B2 – операция  “ИЛИ-НЕ” между содержимым аккумулятора и вторым байтом команды (A) ¬ (A) XOR B2.

Команды сравнения:

- CMP R   –  операция  (A) – (R); если (A) = (R), то Z = 1; если (А) <(R), то С=1;

- CPI_B2  –   операция  (А) – B2; если (A) = B2, то Z = 1; если (A)< B2, то С=1. 

Команды сдвига: 

- RLC – сдвиг влево (каждый бит сдвигается на один разряд влево, а 7 бит переносится в 0 и одновременно записывается в признак (С)) Dm->Dm+1, 
D7->D0, D7->C;

- RRC – сдвиг вправо (каждый бит сдвигается на один разряд вправо, а 0 бит переносится в 7 и одновременно записывается в признак (С)) Dm+1->Dm, D0-> D7, D0->C;

- RAL – сдвиг влево через перенос (каждый бит сдвигается на один разряд влево, 7 бит записывается в признак (С), а бит из (С) записывается в 0 бит) Dm->Dm+1, D7->C, C->D0;

- RAR – сдвиг вправо через перенос (каждый бит сдвигается на один разряд вправо, 0 бит записывается в признак (С), а бит из (С) записывается в 7 бит) Dm+1->Dm, D0->C, C->D7.

Команда инверсии содержимого аккумулятора - СМА     (А) = (A).

Команды безусловного перехода:

- JMP_ В2_ В3 – записать информацию из второго и третьего байта команды в счетчик команд;

- PCHL – записать содержимое пары регистров HL в счетчик команд.

Команды условного перехода:

- JNC – если признак c = 0

- JC  – если признак c = 1

- JNZ – если признак z = 0

- JZ  – если признак z = 1

- JPO – если признак p = 0

- JPE – если признак p = 1

- JP  – если признак s = 0

- JM  – если признак s = 1

то перейти по адресу, записанному во втором и третьем байтах команды,   

иначе перейти к следующей команде.


Команда безусловного вызова подпрограммы :

- CALL_В2_ В3 – вызов подпрограммы с начальным адресом, записанным во втором и третьем байтах команды.


Команды условного вызова подпрограммы:

- CNZ – если z = 0

- CZ  – если z = 1

- CNC – если c = 0

- СС  – если c = 1

- СРО – если p = 0

- СРЕ – если p = 1

- СР  – если s = 0

- CM  – если s = 1

то перейти к подпрограмме с начальным адресом, указанном во втором и третьем байтах команды,

иначе перейти к следующей команде

Команда безусловного возврата из подпрограммы – RET.

Команды условного возврата из подпрограмм:

- RNZ – если z = 0

- RZ  – если z = 1

- RNC – если c = 0

- RС  – если c = 1

- RРО – если p = 0

- RРЕ – если p = 1

- RР  – если s = 0

- RM  – если s = 1

то возвратиться к команде, следующей за командой вызова подпрограммы, 

иначе продолжить выполнение подпрограммы.


Команды операций со стеком:

- PUSH B(D,H) – запись содержимого регистровой пары BC (DE,HL) в стек (B,D,H) ->[ УС-1 ], (C,E,L) ->[ УС-2 ], (УС)=(УС)-2;

- PUSH PSW – запись слова состояния в стек (A) ->[УС-1], (F) ->[ УС-2 ], (УС)=(УС)-2;

- POP B(D,H) – запись из стека в регистровую пару BC(DE,HL) [УС] -> (C,E,L), [УС+1] -> (B,D,H),  (УС)=(УС)+2; 

- POP PSW –  запись слова состояния из стека [УС] -> (F), [УС+1] -> ( A),  (УС)=(УС)+2. 


Команды управления микропроцессором:

- CMC – инверсия признака (С) (С) -> (С);

- STC   – запись 1 в признак (С) 1 -> (С);

- NOP  – команда «нет операции»;

- НLТ  – останов.

Запись программы.

It's empty yet...
 
Назначение кнопок

Кнопка "Пуск" - запускает программу, начиная с адреса указанного в регистре счетчика команд "РС".
Кнопка "Шаг" - выполняет одну команду, начиная с адреса указанного в регистре счетчика команд "РС".
Кнопка "Стоп" - останавливает выполнение программы в режиме прогона.
Кнопка "Сброс" - удаляет все точки останова, очищает регистры, указатель "РС" возвращается в начальное положение.
Кнопка "Память"(справа) - открывает панель "Память", содержащую "Стек"(слева) и "ОЗУ"(справа".

В настройках можно отрегулировать некоторые параметры окна, редактора кода и шрифт.



Справка...
Приложение разработано студентом 1 курса магистратуры ЯГТУ, кафедра "Информационные системы и технологии". Автор Тихомиров Л.И. 2022 г.
При возникновении вопросов пишите на почту: lenusscik@yandex.ru 
Среда разработки Jupiter Notebook. Python version 3.7.1

